(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["confirmOrder"],{"07ac":function(t,e,a){var s=a("23e7"),i=a("6f53").values;s({target:"Object",stat:!0},{values:function(t){return i(t)}})},"6f53":function(t,e,a){var s=a("83ab"),i=a("df75"),r=a("fc6a"),n=a("d1e7").f,c=function(t){return function(e){var a,c=r(e),o=i(c),u=o.length,d=0,h=[];while(u>d)a=o[d++],s&&!n.call(c,a)||h.push(t?[a,c[a]]:c[a]);return h}};t.exports={entries:c(!0),values:c(!1)}},8413:function(t,e,a){},baa5:function(t,e,a){var s=a("23e7"),i=a("e58c");s({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},bf93:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"loading_container"},[a("div",{staticClass:"load_img",style:{backgroundPositionY:-t.positionY%7*2.5+"rem"}})])},i=[],r={data:function(){return{positionY:0,timer:null}},mounted:function(){var t=this;this.timer=setInterval((function(){t.positionY++}),600)},beforeDestroy:function(){clearInterval(this.timer)}},n=r,c=(a("ef94"),a("2877")),o=Object(c["a"])(n,s,i,!1,null,"4795715c",null);e["a"]=o.exports},c51e:function(t,e,a){},e58c:function(t,e,a){"use strict";var s=a("fc6a"),i=a("a691"),r=a("50c4"),n=a("a640"),c=a("ae40"),o=Math.min,u=[].lastIndexOf,d=!!u&&1/[1].lastIndexOf(1,-0)<0,h=n("lastIndexOf"),l=c("indexOf",{ACCESSORS:!0,1:0}),_=d||!h||!l;t.exports=_?function(t){if(d)return u.apply(this,arguments)||0;var e=s(this),a=r(e.length),n=a-1;for(arguments.length>1&&(n=o(n,i(arguments[1]))),n<0&&(n=a+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:u},ef94:function(t,e,a){"use strict";var s=a("c51e"),i=a.n(s);i.a},f11f:function(t,e,a){"use strict";var s=a("8413"),i=a.n(s);i.a},f934:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"confirmOrderContainer"},[t.showLoading?t._e():a("section",{staticClass:"container"},[a("router-link",{staticClass:"address_container",attrs:{to:{path:"/confirmOrder/chooseAddress",query:{id:t.checkoutData.cart.id,sig:t.checkoutData.sig}}}},[a("div",{staticClass:"address_empty_left"},[t.choosedAddress?a("div",{staticClass:"address_detail_container"},[a("header",[a("span",[t._v(t._s(t.choosedAddress.name))]),a("span",[t._v(t._s(1==t.choosedAddress.sex?"先生":"女士"))]),a("span",[t._v("("+t._s(t.choosedAddress.phone)+")")])]),a("div",{staticClass:"address_detail"},[t.choosedAddress.tag?a("span",{style:{backgroundColor:t.iconColor(t.choosedAddress.tag)}},[t._v(t._s(t.choosedAddress.tag))]):t._e(),a("p",[t._v(t._s(t.choosedAddress.address_detail))])])]):a("div",{staticClass:"add_address"},[t._v("请添加一个收货地址")])])]),a("section",{staticClass:"delivery_model"},[a("p",{staticClass:"deliver_text"},[t._v("送达时间")]),a("section",{staticClass:"deliver_time"},[a("p",[t._v("尽快送达 | 预计 "+t._s(t.checkoutData.delivery_reach_time))]),t.checkoutData.cart.is_deliver_by_fengniao?a("p",[t._v("蜂鸟专送")]):t._e()])]),a("section",{staticClass:"pay_way"},[a("header",{staticClass:"header_style"},[a("span",[t._v("支付方式")]),a("div",{staticClass:"more_type",on:{click:t.showPayWayFun}},[a("span",[t._v("在线支付")])])]),t._m(0)]),a("section",{staticClass:"food_list"},[t.checkoutData.cart.restaurant_info?a("header",[a("span",[t._v("店铺：")]),a("img",{attrs:{src:t.imgBaseUrl+t.checkoutData.cart.restaurant_info.image_path}}),a("span",[t._v(t._s(t.checkoutData.cart.restaurant_info.name))])]):t._e(),t.checkoutData.cart.groups?a("ul",{staticClass:"food_list_ul"},t._l(t.checkoutData.cart.groups[0],(function(e){return a("li",{key:e.id,staticClass:"food_item_style"},[a("p",{staticClass:"food_name"},[t._v(t._s(e.name))]),a("div",{staticClass:"num_price"},[a("span",[t._v("x "+t._s(e.quantity))]),a("span",[t._v("¥"+t._s(e.price))])])])})),0):t._e(),t.checkoutData.cart.extra?a("div",{staticClass:"food_item_style"},[a("p",{staticClass:"food_name"},[t._v(t._s(t.checkoutData.cart.extra[0].name))]),a("div",{staticClass:"num_price"},[a("span"),a("span",[t._v("¥ "+t._s(t.checkoutData.cart.extra[0].price))])])]):t._e(),a("div",{staticClass:"food_item_style"},[a("p",{staticClass:"food_name"},[t._v("配送费")]),a("div",{staticClass:"num_price"},[a("span"),a("span",[t._v("¥ "+t._s(t.checkoutData.cart.deliver_amount||0))])])]),a("div",{staticClass:"total_price"},[a("div",{staticClass:"num_price"},[a("span",[t._v("共 ¥"+t._s(t.checkoutData.cart.total))])])])]),a("div",{staticClass:"remark"},[a("span",[t._v("订单备注")]),a("div",{staticClass:"more_type"},[a("span",{staticClass:"ellipsis"},[t._v(t._s(t.remarkText||t.inputText?t.remarklist:"口味、偏好等"))])]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.show_remark=!0}}},[t._v("修改")]),a("el-dialog",{attrs:{title:"备注信息",visible:t.show_remark},on:{"update:visible":function(e){t.show_remark=e}}},[t.remarkList.length?a("section",[a("header",[t._v("快速备注")]),a("ul",t._l(t.remarkList,(function(e,s){return a("li",{key:s},[t._v(" "+t._s(e)+" ")])})),0)]):t._e(),a("el-input",{attrs:{type:"textarea",maxlength:"60","show-word-limit":"",autosize:{minRows:2,maxRows:2},placeholder:"请输入备注信息"},model:{value:t.remark_text,callback:function(e){t.remark_text=e},expression:"remark_text"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.show_remark=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.show_remark=!1}}},[t._v("确 定")])],1)],1)],1),a("div",{staticClass:"remark"},[a("span",[t._v("发票抬头")]),a("span",[t._v(" "+t._s(t.checkoutData.invoice.status_text)+" ")]),a("el-switch",{on:{change:function(e){return t.changeInvoice()}},model:{value:t.changed_invoice,callback:function(e){t.changed_invoice=e},expression:"changed_invoice"}})],1),a("router-link",{attrs:{to:{path:"/confirmOrder/remark",query:{id:t.checkoutData.cart.id,sig:t.checkoutData.sig}}}},[t._v("修改")]),a("router-link",{staticClass:"hongbo",class:{support_is_available:t.checkoutData.invoice.is_available},attrs:{to:t.checkoutData.invoice.is_available?"/confirmOrder/invoice":""}},[t._v("发票")]),a("section",{staticClass:"confirm"},[a("p",[t._v("待支付 ¥"+t._s(t.checkoutData.cart.total))]),a("el-button",{attrs:{type:"primary"},on:{click:t.confrimOrder}},[t._v("确认下单")])],1),a("transition",{attrs:{name:"fade"}},[t.showPayWay?a("div",{staticClass:"cover",on:{click:t.showPayWayFun}}):t._e()]),a("transition",{attrs:{name:"slid_up"}},[t.showPayWay?a("div",{staticClass:"choose_type_Container"},[a("header",[t._v("支付方式")]),a("ul",t._l(t.checkoutData.payments,(function(e){return a("li",{key:e.id,class:{choose:t.payWayId==e.id}},[a("span",[t._v(t._s(e.name)),e.is_online_payment?t._e():a("span",[t._v(t._s(e.description))])]),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.choosePayWay(e.is_online_payment,e.id)}}},[t._v("11")])],1)})),0)]):t._e()])],1),t.showLoading?a("loading"):t._e(),a("transition",{attrs:{name:"router-slid",mode:"out-in"}},[a("router-view")],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"hongbo"},[a("span",[t._v("红包")]),a("span",[t._v("暂时只在饿了么 APP 中支持")])])}],r=(a("4160"),a("baa5"),a("b0c0"),a("07ac"),a("159b"),a("96cf"),a("1da1")),n=a("5530"),c=a("2f62"),o=a("bf93"),u=a("bdaa"),d=a("51be"),h={components:{loading:o["a"]},data:function(){return{geohash:"",shopId:null,showLoading:!0,checkoutData:null,shopCart:null,imgBaseUrl:d["a"],showPayWay:!1,payWayId:1,showAlert:!1,alertText:null,show_remark:!1,remark_text:"",remarkList:[],changed_invoice:""}},computed:Object(n["a"])({},Object(c["d"])(["cartList","remarkText","inputText","invoice","choosedAddress","userInfo"]),{remarklist:function(){var t=new String;return this.remarkText&&Object.values(this.remarkText).forEach((function(e){t+=e[1]+"，"})),this.inputText?t+this.inputText:t.substr(0,t.lastIndexOf("，"))}}),created:function(){this.geohash=this.$route.query.geohash,this.shopId=this.$route.query.shopId,this.INIT_BUYCART(),this.SAVE_SHOPID(this.shopId),this.shopCart=this.cartList[this.shopId]},mounted:function(){this.geohash&&(this.initData(),this.SAVE_GEOHASH(this.geohash))},methods:Object(n["a"])({},Object(c["c"])(["INIT_BUYCART","SAVE_GEOHASH","CHOOSE_ADDRESS","NEED_VALIDATION","SAVE_CART_ID_SIG","SAVE_ORDER_PARAM","ORDER_SUCCESS","SAVE_SHOPID","CONFIRM_REMARK","CONFIRM_INVOICE"]),{initData:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new Array,Object.values(t.shopCart).forEach((function(t){Object.values(t).forEach((function(t){Object.values(t).forEach((function(t){a.push({attrs:[],extra:{},id:t.id,name:t.name,packing_fee:t.packing_fee,price:t.price,quantity:t.num,sku_id:t.sku_id,specs:[t.specs],stock:t.stock})}))}))})),e.next=4,Object(u["d"])(t.geohash,[a],t.shopId).then((function(e){t.checkoutData=e.data,console.log(t.checkoutData)}));case 4:return t.SAVE_CART_ID_SIG({cart_id:t.checkoutData.cart.id,sig:t.checkoutData.sig}),t.initAddress(),e.next=8,Object(u["n"])(t.checkoutData.id,t.checkoutData.sig).then((function(e){var a=e.data.remarks;a.forEach((function(e){e.forEach((function(e){t.remarkList.push(e)}))}))}));case 8:t.showLoading=!1;case 9:case"end":return e.stop()}}),e)})))()},initAddress:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.userInfo||!t.userInfo.user_id){e.next=6;break}return e.next=3,Object(u["i"])(t.userInfo.user_id);case 3:a=e.sent,s=a.data,s instanceof Array&&s.length&&t.CHOOSE_ADDRESS({address:s[0],index:0});case 6:case"end":return e.stop()}}),e)})))()},showPayWayFun:function(){this.showPayWay=!this.showPayWay},choosePayWay:function(t,e){t&&(this.showPayWay=!this.showPayWay,this.payWayId=e)},iconColor:function(t){switch(t){case"公司":return"#4cd964";case"学校":return"#3190e8"}},changeInvoice:function(){this.changed_invoice=!this.changed_invoice,this.CONFIRM_INVOICE(this.changed_invoice)},confrimOrder:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.userInfo&&t.userInfo.user_id){e.next=5;break}return t.$confirm("当前未登录账号, 是否登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$router.push("/login")})).catch(err),e.abrupt("return");case 5:if(t.choosedAddress){e.next=8;break}return t.$message({showClose:!0,message:"当前还没填写收货地址，请去填写",type:"warning"}),e.abrupt("return");case 8:t.SAVE_ORDER_PARAM({user_id:t.userInfo.user_id,cart_id:t.checkoutData.cart.id,address_id:t.choosedAddress.id,description:t.remarklist,entities:t.checkoutData.cart.groups,geohash:t.geohash,sig:t.checkoutData.sig}),Object(u["t"])(t.userInfo.user_id,t.checkoutData.cart.id,t.choosedAddress.id,t.remarklist,t.checkoutData.cart.groups,t.geohash,t.checkoutData.sig).then((function(e){e.need_validation?(t.NEED_VALIDATION(e.data),t.$router.push("/confirmOrder/userValidation")):(t.ORDER_SUCCESS(e.data),t.$router.push("/confirmOrder/payment"))}));case 10:case"end":return e.stop()}}),e)})))()}}),watch:{userInfo:function(t){t&&t.user_id&&this.initAddress()}}},l=h,_=(a("f11f"),a("2877")),f=Object(_["a"])(l,s,i,!1,null,"ff73af90",null);e["default"]=f.exports}}]);
//# sourceMappingURL=confirmOrder.836c351d.js.map